<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cp.dao.RoleMapperExtra" >
	<select id="getRoleById" resultType="java.util.HashMap">
		SELECT r.id,r.`name`,remark,o.`name` AS creatorName,creator_id AS creatorId FROM role r
		LEFT JOIN operator AS o ON r.creator_id = o.user_id WHERE r.id = #{id,jdbcType=VARCHAR}
	</select>
	
	<delete id="deleteRoles">
		DELETE FROM role WHERE id IN
		<foreach collection="ids" item="id" open="(" separator="," close=")">
			#{id,jdbcType=VARCHAR}
		</foreach>
	</delete>
	
	<sql id="limitCondition">
		<if test="start >= 0">
			LIMIT #{start,jdbcType=INTEGER},#{end,jdbcType=INTEGER}
		</if>
	</sql>
	
	<select id="getRoles" resultType="java.util.HashMap">
		SELECT r.id,r.`name`,r.remark,o.`name` AS creatorName FROM role AS r LEFT JOIN operator AS o ON r.creator_id = o.user_id
		WHERE 1 = 1
		<if test="creatorId != null">
			AND r.creator_id = #{creatorId,jdbcType=VARCHAR}
		</if>
		<if test="rsDTO.roleName != null">
			AND r.`name` LIKE <![CDATA[CONCAT('%',#{rsDTO.roleName,jdbcType=VARCHAR},'%')]]>
		</if>
		<if test="rsDTO.creatorName != null">
			AND o.`name` LIKE <![CDATA[CONCAT('%',#{rsDTO.creatorName,jdbcType=VARCHAR},'%')]]>
		</if>
		<include refid="limitCondition"></include>
	</select>
</mapper>